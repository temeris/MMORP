<!DOCTYPE html>

<html>
	<head>
		<title>Projet MMORPG</title>
		<meta charset="utf-8"/>
		<link rel="stylesheet" type="text/css" href="/test.css"/>
	</head>

	<body>
        <script src="/socket.io/socket.io.js"></script>
		<h1 style="text-align:center">WORLD OF ROTI</h1>
		<canvas id="myCanvas">	
			<script>
				var socket = io.connect('http://localhost:8080');
				var canvas = document.getElementById('myCanvas');
				var ctx = canvas.getContext("2d");
				
				socket.on('lancement', function(player){
					player.name = prompt("Pseudo ?");
					socket.emit('reponse',player,ctx,canvas);
					socket.emit('init_position_depart',player);
				});
				socket.on('ma_position',function(player){
					ctx.fillStyle="blue";
					ctx.fillRect(player.x,player.y,10,10);
				});
				socket.on('position_depart_players',function(player){
					ctx.fillStyle="black";
					ctx.fillRect(player.x,player.y,10,10);
				});
				canvas.onclick = function(evt){
					var data = getMousePos(canvas,evt);
					socket.emit('action',data);
				}
				function getMousePos(canvas, evt) {
					var rect = canvas.getBoundingClientRect();
					return {
						x: evt.clientX - rect.left,
						y: evt.clientY - rect.top
					};
				}
				
				socket.on('mouvement_pour_moi',function(player){
					ctx.clearRect(0,0,canvas.width,canvas.height);
					ctx.fillStyle="blue";
					ctx.fillRect(player.x,player.y,10,10);
				});
				socket.on('mouvement_pour_autres',function(player){
					ctx.clearRect(0,0,canvas.width,canvas.height);
					ctx.fillStyle="black";
					ctx.fillRect(player.x,player.y,10,10);
				});
				
					</script>
		</canvas>	
	</body>
</html>
